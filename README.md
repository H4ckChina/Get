```易语言
.版本 2
.支持库 shellEx
.支持库 iext

.程序集 窗口程序集_启动窗口
.程序集变量 集_结束热键, 整数型

.子程序 __启动窗口_创建完毕

窗口_置穿透 (_启动窗口.取窗口句柄 (), 真)
集_结束热键 ＝ 注册热键 (_启动窗口.取窗口句柄 (), 标签_热键.取窗口句柄 (), 0, #Del键)
_启动窗口.左边 ＝ 取屏幕宽度 () － _启动窗口.宽度
_启动窗口.顶边 ＝ 取屏幕高度 () － _启动窗口.高度
线程_启动 (&子_循环获取, , )
线程_启动 (&子_颜色获取, , )

.子程序 子_循环获取
.局部变量 局_网页数据, 文本型
.局部变量 局_当前算力, 文本型
.局部变量 局_当前后缀, 文本型
.局部变量 局_未付金额, 文本型
.局部变量 局_已付金额, 文本型
.局部变量 局_当前价格, 文本型
.局部变量 局_获取失败, 整数型

.判断循环首 (真)
    局_网页数据 ＝ 网页_访问S (“http://get.h4ckchina.com”, 0, , , , , , , , , , , , , , , , , , , )

    .如果 (文本_取出中间文本 (局_网页数据, “Hash” ＋ #引号 ＋ “:” ＋ #引号, #引号 ＋ “,”, , ) ＝ “”)

    .否则
        局_当前算力 ＝ 文本_取出中间文本 (局_网页数据, “Hash” ＋ #引号 ＋ “:” ＋ #引号, #引号 ＋ “,”, , )
    .如果结束
    .如果 (文本_取出中间文本 (局_网页数据, “No” ＋ #引号 ＋ “:” ＋ #引号, #引号 ＋ “,”, , ) ＝ “”)

    .否则
        局_未付金额 ＝ 文本_取出中间文本 (局_网页数据, “No” ＋ #引号 ＋ “:” ＋ #引号, #引号 ＋ “,”, , )
    .如果结束
    .如果 (文本_取出中间文本 (局_网页数据, “Yes” ＋ #引号 ＋ “:” ＋ #引号, #引号 ＋ “,”, , ) ＝ “”)

    .否则
        局_已付金额 ＝ 文本_取出中间文本 (局_网页数据, “Yes” ＋ #引号 ＋ “:” ＋ #引号, #引号 ＋ “,”, , )
    .如果结束
    .如果 (文本_取出中间文本 (局_网页数据, “CNY” ＋ #引号 ＋ “:” ＋ #引号, #引号, , ) ＝ “”)

    .否则
        局_当前价格 ＝ 文本_取出中间文本 (局_网页数据, “CNY” ＋ #引号 ＋ “:” ＋ #引号, #引号, , )
    .如果结束
    .如果 (文本_取出中间文本 (局_网页数据, “Hash” ＋ #引号 ＋ “:” ＋ #引号, #引号 ＋ “,”, , ) ＝ “”)
        局_获取失败 ＝ 局_获取失败 ＋ 1
    .否则
        局_获取失败 ＝ 0
    .如果结束
    .如果真 (局_获取失败 ＝ 3)
        局_当前算力 ＝ “”
        局_未付金额 ＝ “”
        局_已付金额 ＝ “”
    .如果真结束


    透明标签_算力.标题 ＝ “当前算力：” ＋ 局_当前算力

    透明标签_未付.标题 ＝ “未付金额：” ＋ 局_未付金额

    透明标签_已付.标题 ＝ “已付金额：” ＋ 局_已付金额

    透明标签_价格.标题 ＝ “当前价格：” ＋ 局_当前价格 ＋ “ CNY”

    Sleep (60000)
.判断循环尾 ()

.子程序 子_颜色获取

.判断循环首 (真)
    .如果 (取文本左边 (运算_颜色转换 (窗口_取坐标处颜色 (, _启动窗口.左边, _启动窗口.顶边)), 1) ＝ “0” 或 取文本左边 (运算_颜色转换 (窗口_取坐标处颜色 (, _启动窗口.左边, _启动窗口.顶边)), 1) ＝ “1” 或 取文本左边 (运算_颜色转换 (窗口_取坐标处颜色 (, _启动窗口.左边, _启动窗口.顶边)), 1) ＝ “2” 或 取文本左边 (运算_颜色转换 (窗口_取坐标处颜色 (, _启动窗口.左边, _启动窗口.顶边)), 1) ＝ “3” 或 取文本左边 (运算_颜色转换 (窗口_取坐标处颜色 (, _启动窗口.左边, _启动窗口.顶边)), 1) ＝ “4” 或 取文本左边 (运算_颜色转换 (窗口_取坐标处颜色 (, _启动窗口.左边, _启动窗口.顶边)), 1) ＝ “5”)
        _启动窗口.底色 ＝ #黑色
        窗口_置透明颜色 (_启动窗口.取窗口句柄 (), #黑色)
    .否则
        .如果 (取文本左边 (运算_颜色转换 (窗口_取坐标处颜色 (, _启动窗口.左边, _启动窗口.顶边)), 1) ＝ “D”)
            _启动窗口.底色 ＝ #浅灰
            窗口_置透明颜色 (_启动窗口.取窗口句柄 (), #浅灰)
        .否则
            _启动窗口.底色 ＝ #白色
            窗口_置透明颜色 (_启动窗口.取窗口句柄 (), #白色)
        .如果结束

    .如果结束
    Sleep (100)
.判断循环尾 ()

.子程序 运算_颜色转换, 文本型, 公开, 将10进制的颜色值转到16进制的颜色值；   还原调用 网页_取十进制颜色值
.参数 待转换颜色值, 整数型
.局部变量 字节集, 字节集
.局部变量 十六进制颜色, 文本型

字节集 ＝ 到字节集 (待转换颜色值)
十六进制颜色 ＝ 取文本右边 (“00” ＋ 取十六进制文本 (字节集 [1]), 2)
十六进制颜色 ＝ 十六进制颜色 ＋ 取文本右边 (“00” ＋ 取十六进制文本 (字节集 [2]), 2)
十六进制颜色 ＝ 十六进制颜色 ＋ 取文本右边 (“00” ＋ 取十六进制文本 (字节集 [3]), 2)
返回 (十六进制颜色)

.子程序 _标签_热键_反馈事件, 整数型
.参数 参数一, 整数型
.参数 参数二, 整数型

.如果真 (参数一 ＝ 集_结束热键)
    结束 ()
.如果真结束
